# 性能管理配置（性能瓶颈分析）<a name="cce_10_0055"></a>

## 操作场景<a name="section4287717163411"></a>

应用性能管理服务（APM）当前支持给JAVA类工作负载提供调用链、拓扑等监控能力。您可为JAVA类工作负载安装APM探针，以提供更精准的问题分析与定位，协助您高效解决应用难题。

工作负载创建时和创建后，均可以对JAVA类工作负载监控进行设置。

>![](public_sys-resources/icon-note.gif) **说明：** 
>-   如果您已经使用CCE部署了容器应用，您需要应用性能管理时，需要将容器服务上的JAVA应用通过Pinpoint探针接入到APM，详细介绍请参见[为部署在CCE容器中的JAVA应用安装Agent](https://support.huaweicloud.com/qs-apm2/apm_02_0005.html)。

## 前提条件<a name="section295421111312"></a>

若您还未开通APM服务，请前往APM控制台，并参照界面提示进行开通。

## 操作步骤<a name="section62500100162257"></a>

1.  登录CCE管理控制台。
2.  在创建工作负载时，在“高级设置“中找到“性能管理配置“。探针默认状态为“不启用“，您可根据需求选择“APM1.0探针“或“APM2.0探针“。开启后将会通过应用性能管理服务针对JAVA程序提供更精准的问题分析与定位。

    >![](public_sys-resources/icon-note.gif) **说明：** 
    >1.  启用APM探针后会自动新增一个名为init-pinpoint（APM1.0 探针）或者 init-javaagent（APM2.0 探针）的初始化容器用来初始化探针, 并分配 0.25 Core CPU 和 250 MiB 内存供初始化容器使用。
    >2.  启用APM探针后会给所有业务容器自动添加环境变量：PAAS\_MONITORING\_GROUP、JAVA\_TOOL\_OPTIONS、PAAS\_CLUSTER\_ID。
    >3.  启用APM探针后会给所有业务容器自动挂载一个名为paas-apm（APM1.0 探针）或者paas-apm2（APM1.0 探针）的本地存储卷。

3.  填写探针相关参数。

    **APM1.0探针**

    -   监控组：输入监控组名称，如testapp。若已有监控组，可下拉选择。
    -   探针版本：选择探针的版本。
    -   “探针升级策略“，默认为“重启自动升级“。
        -   重启自动升级：每次都尝试重新下载镜像。
        -   重启手动升级：如果本地有该镜像，则使用本地镜像，本地不存在时下载镜像。

    **APM2.0探针**

    -   探针版本：选择探针的版本。
    -   “探针升级策略“，默认为“重启自动升级“。
        -   重启自动升级：每次都尝试重新下载镜像。
        -   重启手动升级：如果本地有该镜像，则使用本地镜像，本地不存在时下载镜像。

    -   APM环境：输入APM环境名称，该参数为选填。
    -   APM应用：选择一个已有的APM应用。
    -   子应用：输入APM子应用，该参数为选填。
    -   接入密钥：将会自动获取APM服务的密钥信息，可前往APM控制台查看密钥详情。

4.  应用启动后，等待约3分钟，应用数据就会呈现在APM界面中，此时登录APM，您可以在APM上通过拓扑、调用链等进行应用性能优化，详细操作请参考[应用拓扑](https://support.huaweicloud.com/usermanual-apm2/apm_07_0019.html)。

