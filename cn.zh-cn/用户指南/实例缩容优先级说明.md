# 实例缩容优先级说明<a name="cce_10_0366"></a>

## 缩容优先级<a name="section11633185245119"></a>

Pod在缩容时，会按照如下优先级缩容：

1.  未被调度的Pod
2.  Pod Pending < Pod Unknown < Pod Running
3.  Not ready < ready
4.  带有特定标签的Pod，cce.io/priordeletion
5.  <a name="li1169032015413"></a>Doubled up < not doubled up 优先缩容Pod多的节点
6.  <a name="li942035615548"></a>缩容Ready时间较长的Pod
7.  重启次数多的Pod
8.  createtimestamp较前的Pod

## 优先缩容老实例生效说明<a name="section4910128932"></a>

-   优先缩容老实例**不生效**：

    按照上述优先级，如果节点数为2（同规格），Deployment实例数为5时（可以是任意奇数个），此时A节点分布3个Pod，B节点分布2个Pod；如果此时将实例数缩容至3个，上述步骤中会先执行[5](#li1169032015413)，此时根据Pod判断，会确定缩容的节点为A；再执行[6](#li942035615548)，缩容一个老实例后发现目前已无老实例，且限定了缩容节点为A，此时会缩容一个新实例。

-   优先缩容老实例**生效**：如果节点数为2（同规格），Deployment实例数为6时（可以是任意偶数个），此时A、B节点均分布3个Pod；如果此时将实例数缩容至4个，此时代码会判定不符合[5](#li1169032015413)的条件，此时根据Pod判断，会确定缩容的节点为A、B；再执行[6](#li942035615548)，回去将两个节点上的实例排序，成功缩容两个老的实例。

